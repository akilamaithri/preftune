Loading python3/3.10.4
  Loading requirement: intel-mkl/2021.4.0
[92mINFO [0m:      Starting Flower ServerApp, config: num_rounds=100, no round_timeout
[92mINFO [0m:      
[92mINFO [0m:      [INIT]
[92mINFO [0m:      Using initial global parameters provided by strategy
[92mINFO [0m:      Starting evaluation of initial global parameters
[92mINFO [0m:      initial parameters (loss, other metrics): 0.0, {}
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 1]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (1, 0.0, {}, 10.096650480758399)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (2, 0.0, {}, 10.433855550829321)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (3, 0.0, {}, 10.77084988169372)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (4, 0.0, {}, 11.088418702594936)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (5, 0.0, {}, 35.86103689158335)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (6, 0.0, {}, 36.0994188785553)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (7, 0.0, {}, 36.44003744563088)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (8, 0.0, {}, 36.76848476473242)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 9]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (9, 0.0, {}, 36.988481803797185)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 10]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (10, 0.0, {}, 59.8070590547286)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 11]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (11, 0.0, {}, 60.047195004764944)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 12]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (12, 0.0, {}, 60.27341239666566)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 13]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (13, 0.0, {}, 60.6068208348006)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 14]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (14, 0.0, {}, 60.833457320928574)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 15]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (15, 0.0, {}, 83.11763228755444)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 16]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (16, 0.0, {}, 83.54155858559534)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 17]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (17, 0.0, {}, 83.77167916158214)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 18]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (18, 0.0, {}, 84.02271138364449)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 19]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (19, 0.0, {}, 84.35769296158105)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 20]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (20, 0.0, {}, 106.27188774896786)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 21]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (21, 0.0, {}, 106.51310193073004)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 22]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (22, 0.0, {}, 106.7378326067701)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 23]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (23, 0.0, {}, 107.07905039889738)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 24]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (24, 0.0, {}, 107.3097678059712)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 25]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (25, 0.0, {}, 129.51272869994864)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 26]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (26, 0.0, {}, 129.89135952666402)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 27]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (27, 0.0, {}, 130.1140626417473)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 28]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (28, 0.0, {}, 130.35757936676964)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 29]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (29, 0.0, {}, 130.69662049459293)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 30]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (30, 0.0, {}, 153.3168366877362)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 31]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (31, 0.0, {}, 153.8616243088618)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 32]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (32, 0.0, {}, 154.0848803408444)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 33]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (33, 0.0, {}, 154.30444670189172)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 34]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (34, 0.0, {}, 154.52680508373305)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 35]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (35, 0.0, {}, 176.98087282059714)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 36]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (36, 0.0, {}, 177.22248901473358)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 37]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (37, 0.0, {}, 177.4723975979723)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 38]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (38, 0.0, {}, 177.69241657899693)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 39]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (39, 0.0, {}, 177.92739283386618)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 40]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (40, 0.0, {}, 201.39647443871945)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 41]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (41, 0.0, {}, 201.84670500690117)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 42]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (42, 0.0, {}, 202.20850935857743)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 43]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (43, 0.0, {}, 202.55365004297346)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 44]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (44, 0.0, {}, 202.77749663358554)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 45]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (45, 0.0, {}, 225.11794937495142)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 46]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (46, 0.0, {}, 225.36700629489496)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 47]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (47, 0.0, {}, 225.70954485982656)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 48]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (48, 0.0, {}, 226.0431496789679)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 49]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (49, 0.0, {}, 226.27516308100894)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 50]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (50, 0.0, {}, 247.7394796567969)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 51]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (51, 0.0, {}, 247.9665516577661)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 52]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (52, 0.0, {}, 248.2071619266644)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 53]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (53, 0.0, {}, 248.65229192189872)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 54]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (54, 0.0, {}, 248.8796293856576)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 55]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (55, 0.0, {}, 270.92181722680107)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 56]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (56, 0.0, {}, 271.25905440794304)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 57]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (57, 0.0, {}, 271.4789915829897)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 58]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (58, 0.0, {}, 271.7087704818696)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 59]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (59, 0.0, {}, 271.925998554565)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 60]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (60, 0.0, {}, 292.9142230497673)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 61]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (61, 0.0, {}, 293.13858397398144)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 62]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (62, 0.0, {}, 293.3627385389991)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 63]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (63, 0.0, {}, 293.69028244679794)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 64]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (64, 0.0, {}, 293.91551597462967)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 65]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (65, 0.0, {}, 316.9725246988237)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 66]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (66, 0.0, {}, 317.24990092776716)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 67]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (67, 0.0, {}, 317.47812720481306)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 68]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (68, 0.0, {}, 317.6983980117366)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 69]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (69, 0.0, {}, 317.93671257188544)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 70]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (70, 0.0, {}, 339.667018965818)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 71]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (71, 0.0, {}, 340.0233506998047)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 72]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (72, 0.0, {}, 340.36623196396977)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 73]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (73, 0.0, {}, 340.5918247718364)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 74]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (74, 0.0, {}, 340.8108044429682)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 75]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (75, 0.0, {}, 363.4580818307586)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 76]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (76, 0.0, {}, 363.8217407958582)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 77]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (77, 0.0, {}, 364.1539315576665)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 78]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (78, 0.0, {}, 364.496100560762)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 79]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (79, 0.0, {}, 364.7176787047647)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 80]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (80, 0.0, {}, 386.2045209337957)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 81]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (81, 0.0, {}, 386.6554275029339)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 82]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (82, 0.0, {}, 386.98279086872935)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 83]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (83, 0.0, {}, 387.20741921057925)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 84]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (84, 0.0, {}, 387.4568251715973)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 85]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (85, 0.0, {}, 410.6003604149446)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 86]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (86, 0.0, {}, 410.95203015580773)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 87]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (87, 0.0, {}, 411.1949199126102)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 88]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (88, 0.0, {}, 411.43643868295476)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 89]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (89, 0.0, {}, 411.78501880168915)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 90]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (90, 0.0, {}, 433.5312361395918)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 91]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (91, 0.0, {}, 433.871348539833)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 92]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (92, 0.0, {}, 434.0980773018673)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 93]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (93, 0.0, {}, 434.4319059867412)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 94]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (94, 0.0, {}, 434.6556436419487)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 95]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (95, 0.0, {}, 457.22941510984674)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 96]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (96, 0.0, {}, 457.6164215817116)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 97]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (97, 0.0, {}, 457.8593872548081)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 98]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (98, 0.0, {}, 458.556169712916)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 99]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (99, 0.0, {}, 458.8865045788698)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 100]
[92mINFO [0m:      configure_fit: strategy sampled 2 clients (out of 20)
[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[91mERROR [0m:     An exception was raised when processing a message by RayBackend
[91mERROR [0m:     [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'
[91mERROR [0m:     Traceback (most recent call last):
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/vce_api.py", line 112, in worker
    out_mssg, updated_context = backend.process_message(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 187, in process_message
    raise ex
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/server/superlink/fleet/vce/backend/raybackend.py", line 175, in process_message
    ) = self.pool.fetch_result_and_return_actor_to_pool(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 480, in fetch_result_and_return_actor_to_pool
    _, out_mssg, updated_context = ray.get(future)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 2639, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 144, in __call__
    return self._call(message, context)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/client_app.py", line 128, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 96, in handle_legacy_message_from_msgtype
    client = client_fn(context)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/client_app.py", line 107, in client_fn
    client_trainset = load_data(partition_id, num_partitions, cfg.dataset.name)
  File "/scratch/wd04/sm0074/preftune/flowertune_llm/dataset.py", line 58, in load_data
    FDS = partitioner.partition(train_data)  # âœ… FIXED
AttributeError: 'IidPartitioner' object has no attribute 'partition'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=760396, ip=10.6.136.1, actor_id=2e8e732500934c7f3875e4b901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x14b1317ef8e0>)
  File "/scratch/wd04/sm0074/preftune_env_py310/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'IidPartitioner' object has no attribute 'partition'

[92mINFO [0m:      aggregate_fit: received 0 results and 2 failures
[92mINFO [0m:      fit progress: (100, 0.0, {}, 481.852308570873)
[92mINFO [0m:      configure_evaluate: no clients selected, skipping evaluation
[92mINFO [0m:      
[92mINFO [0m:      [SUMMARY]
[92mINFO [0m:      Run finished 100 round(s) in 481.86s
[92mINFO [0m:      	History (loss, centralized):
[92mINFO [0m:      		round 0: 0.0
[92mINFO [0m:      		round 1: 0.0
[92mINFO [0m:      		round 2: 0.0
[92mINFO [0m:      		round 3: 0.0
[92mINFO [0m:      		round 4: 0.0
[92mINFO [0m:      		round 5: 0.0
[92mINFO [0m:      		round 6: 0.0
[92mINFO [0m:      		round 7: 0.0
[92mINFO [0m:      		round 8: 0.0
[92mINFO [0m:      		round 9: 0.0
[92mINFO [0m:      		round 10: 0.0
[92mINFO [0m:      		round 11: 0.0
[92mINFO [0m:      		round 12: 0.0
[92mINFO [0m:      		round 13: 0.0
[92mINFO [0m:      		round 14: 0.0
[92mINFO [0m:      		round 15: 0.0
[92mINFO [0m:      		round 16: 0.0
[92mINFO [0m:      		round 17: 0.0
[92mINFO [0m:      		round 18: 0.0
[92mINFO [0m:      		round 19: 0.0
[92mINFO [0m:      		round 20: 0.0
[92mINFO [0m:      		round 21: 0.0
[92mINFO [0m:      		round 22: 0.0
[92mINFO [0m:      		round 23: 0.0
[92mINFO [0m:      		round 24: 0.0
[92mINFO [0m:      		round 25: 0.0
[92mINFO [0m:      		round 26: 0.0
[92mINFO [0m:      		round 27: 0.0
[92mINFO [0m:      		round 28: 0.0
[92mINFO [0m:      		round 29: 0.0
[92mINFO [0m:      		round 30: 0.0
[92mINFO [0m:      		round 31: 0.0
[92mINFO [0m:      		round 32: 0.0
[92mINFO [0m:      		round 33: 0.0
[92mINFO [0m:      		round 34: 0.0
[92mINFO [0m:      		round 35: 0.0
[92mINFO [0m:      		round 36: 0.0
[92mINFO [0m:      		round 37: 0.0
[92mINFO [0m:      		round 38: 0.0
[92mINFO [0m:      		round 39: 0.0
[92mINFO [0m:      		round 40: 0.0
[92mINFO [0m:      		round 41: 0.0
[92mINFO [0m:      		round 42: 0.0
[92mINFO [0m:      		round 43: 0.0
[92mINFO [0m:      		round 44: 0.0
[92mINFO [0m:      		round 45: 0.0
[92mINFO [0m:      		round 46: 0.0
[92mINFO [0m:      		round 47: 0.0
[92mINFO [0m:      		round 48: 0.0
[92mINFO [0m:      		round 49: 0.0
[92mINFO [0m:      		round 50: 0.0
[92mINFO [0m:      		round 51: 0.0
[92mINFO [0m:      		round 52: 0.0
[92mINFO [0m:      		round 53: 0.0
[92mINFO [0m:      		round 54: 0.0
[92mINFO [0m:      		round 55: 0.0
[92mINFO [0m:      		round 56: 0.0
[92mINFO [0m:      		round 57: 0.0
[92mINFO [0m:      		round 58: 0.0
[92mINFO [0m:      		round 59: 0.0
[92mINFO [0m:      		round 60: 0.0
[92mINFO [0m:      		round 61: 0.0
[92mINFO [0m:      		round 62: 0.0
[92mINFO [0m:      		round 63: 0.0
[92mINFO [0m:      		round 64: 0.0
[92mINFO [0m:      		round 65: 0.0
[92mINFO [0m:      		round 66: 0.0
[92mINFO [0m:      		round 67: 0.0
[92mINFO [0m:      		round 68: 0.0
[92mINFO [0m:      		round 69: 0.0
[92mINFO [0m:      		round 70: 0.0
[92mINFO [0m:      		round 71: 0.0
[92mINFO [0m:      		round 72: 0.0
[92mINFO [0m:      		round 73: 0.0
[92mINFO [0m:      		round 74: 0.0
[92mINFO [0m:      		round 75: 0.0
[92mINFO [0m:      		round 76: 0.0
[92mINFO [0m:      		round 77: 0.0
[92mINFO [0m:      		round 78: 0.0
[92mINFO [0m:      		round 79: 0.0
[92mINFO [0m:      		round 80: 0.0
[92mINFO [0m:      		round 81: 0.0
[92mINFO [0m:      		round 82: 0.0
[92mINFO [0m:      		round 83: 0.0
[92mINFO [0m:      		round 84: 0.0
[92mINFO [0m:      		round 85: 0.0
[92mINFO [0m:      		round 86: 0.0
[92mINFO [0m:      		round 87: 0.0
[92mINFO [0m:      		round 88: 0.0
[92mINFO [0m:      		round 89: 0.0
[92mINFO [0m:      		round 90: 0.0
[92mINFO [0m:      		round 91: 0.0
[92mINFO [0m:      		round 92: 0.0
[92mINFO [0m:      		round 93: 0.0
[92mINFO [0m:      		round 94: 0.0
[92mINFO [0m:      		round 95: 0.0
[92mINFO [0m:      		round 96: 0.0
[92mINFO [0m:      		round 97: 0.0
[92mINFO [0m:      		round 98: 0.0
[92mINFO [0m:      		round 99: 0.0
[92mINFO [0m:      		round 100: 0.0
[92mINFO [0m:      
